<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta http-equiv="content-type"
 content="text/html; charset=ISO-8859-1">
  <title>Welcome to PICFLOAT project page</title>
</head>
<body>
<h1>PICFLOAT</h1>
<h3>Floating point library for PIC micro controllers</h3>
<h3>PICFLOAT is a open source floating point library for midrange PIC
processors from Microchip.</h3>
<span style="font-weight: bold;">Language Used:</span> PIC Assembler<br>
<div style="margin-left: 40px;">Note: the test utilities and utilities
for creating floating point
numbers
are in C<br>
<br>
</div>
<span style="font-weight: bold;">Tools Needed:</span> <a
 href="http://gputils.sourceforge.net/">GPASM</a> or <a
 href="http://www.microchip.com">MPASM</a>, GCC and Make<br>
<br>
<span style="font-weight: bold;">License:</span> <a
 href="http://opensource.org/licenses/bsd-license.php">BSD</a><br>
<br>
<span style="font-weight: bold;">Format: </span>IEEE 32bit single and
40bit format (8bit signed exponent,32bit mantissa, 1bit sign -
calculations are done in 40bit format including trig,log, etc)<br>
<br>
<span style="font-weight: bold;">Main features: </span><br>
&nbsp;- small size - <span
 style="font-weight: bold; font-style: italic; text-decoration: underline;">all
of it</span><span
 style="font-style: italic; text-decoration: underline;"> -</span> and
testing code fits inside 2K code!<br>
&nbsp;- heavy use of macros (over 300) makes code readable and portable<br>
&nbsp;- only assume one 8bit register called W (easy to change) - and
limited use of an&nbsp; index register<br>
&nbsp;- testing is done with paranoia math test suite<br>
<br>
<span style="font-weight: bold;">Target PIC Processors:</span> 14bit
processors (initial port)<br>
<br>
<span style="font-weight: bold;">Support Utilities:&nbsp; </span>Includes
programs to generate tables or constants from floating point numbers
that can be included in assembler code<br>
<br>
<span style="font-weight: bold;">Testing of core math function:</span><br>
<div style="margin-left: 40px;">I have run this code
against the <a href="http://www.moshier.net">PARANOIA</a> test suite
by Steve Moshier using a modified
version of the PIC
simulator <a href="http://sourceforge.net/projects/psim">PSIM</a> by
Eric Smith<br>
See support links<br>
</div>
<br>
<br>
<span style="font-weight: bold;">Details:</span><br>
<div style="margin-left: 40px;"><span style="font-weight: bold;">Macros:</span>
define all core multibyte functions (1 to N byte size!) to make
building function easy; such as: <br>
<div style="margin-left: 40px;">-Arithmetic, Logical, Shifts, Compares,
Load (Direct and Constant), Store, Bit Operations, Looping, Increment,
Decrement, Jumps<br>
Macros are also used to invoke all function calls (for readability and
mainly to allow modification of calling methods on various PICs)<br>
</div>
<span style="font-weight: bold;">32bit math:&nbsp;</span> 32bit integer
functions based on macro headers including Multiply, Divide,
Conversions to/from 8, 16, 24 and 32bit signed/unsigned values<br>
<span style="font-weight: bold;">I/O: 32bit BCD:</span> convert up to
32bit
numbers to BCD and output results in ASCII, ATOI convert ASCII to 32bit<br>
<span style="font-weight: bold;">Floating point core:</span>&nbsp;
Conversions (IEEE to/from 40bit temporary real) Load/Store ( to/from
IEEE or 40bit temporary real)&nbsp; Arithmetic, Increment, Decrement, <br>
<div style="margin-left: 40px;">Conversions (to/from 8, 16, 24, 32bit
integers signed/unsigned)<br>
</div>
<span style="font-weight: bold;">Floating point functions:</span> Poly,
Sqrt, Sin, Cos, Tan, Asin, Acos, Atan, Log, Exp, Pow, Test
(Zero/Nonzero), Split(Real,Integer), Floor, Ceil, LDEXP, FREXP, FMOD,
INVERT(1/X)<br>
</div>
<div style="margin-left: 40px;"><span style="font-weight: bold;">Floating
Point I/O:</span> FTOA - Binary to ASCII floating and&nbsp; ATOF ASCII
to floating conversions supporting scientific notation<br>
</div>
<div style="margin-left: 40px;"><span style="font-weight: bold;">Table
functions</span>:&nbsp; 32bit math, 40 and 32bit Floating point load <br>
<span style="font-weight: bold;">Memory functions:</span> memory copy<br>
<br>
<br>
<span style="font-weight: bold;">AND MUCH MORE!<br>
<br>
</span></div>
<span style="font-weight: bold;">Background:<br>
</span>
<div style="margin-left: 40px;">I started working on this project back
in 1990. I started with a macro library to make using the PIC easier to
use. I felt that having a generic base of multi-byte functions would
allow making math libraries mush easier to do. I had the floating point
core written in 1991. The project was revisited over the years to
include most of the common C floating point math functions. I had
planned to have the library as part of an interpreter with the higher
level functions and data kept in NVRAM. This has much to do with why
there is no banking code in this project (It would be easy to have this
code and a small interpreter fit inside of 2K code if many of the
functions were moved to NVRAM)<br>
</div>
<div style="margin-left: 40px;"><br>
</div>
<span style="font-weight: bold;">Wish List:</span><br>
<div style="margin-left: 40px;">I hope others can work on and expand on
this project. Some ideas for areas improvement could be<br>
<ul>
  <li>Some method to compile in only functions that are used&nbsp; -
perhaps a preprocessor stage.<br>
  </li>
  <li>Use of index register for argument passing and computations</li>
  <li>Add a stack <br>
  </li>
  <li>Better error reporting<br>
  </li>
  <li>Consider alternate range reduction methods for TRIG functions <br>
  </li>
  <li>Add statistical testing for host/simulator testing of
TRIG,LOG,EXP functions</li>
  <li>We compute the mantissa to 32bits so add double support to host
testing functions - the float limit hides much of the real accuracy of
the functions <br>
  </li>
</ul>
<br>
</div>
<span style="font-weight: bold;">Comments:</span><br>
<div style="margin-left: 40px;">I believe that prior to this project
that PIC assembler support for floating point
functions, and good macro support in general, has been seriously
lacking.<br>
Keep in mind the limited numeric resolution resulting from the number
formats themselves when doing computations! Take a <span
 style="font-weight: bold;"></span>small number, say delta, and add
another number that is larger in magnitude by 2**(bits of precision) -
the delta contribution is lost.. A good example of this problem occurs
when passing two angles near 90 degrees that differ by a small ammont -
if you are depending on measuring small changes in these angles your
results will&nbsp; have large unexpected errors - so take time to
understand this limit and rework your computations as required. No
amount of design given to a mathematical functions can compensate from
being badly used. (But please feel free to fix any bugs you may find in
my code 8-)<br>
<br>
</div>
<span style="font-weight: bold;">Misc:</span><br>
<div style="margin-left: 40px;">If anyone is interested in tools to
make interpreters I would suggest using the <a
 href="http://cs.ru.ac.za/homes/cspt/cocor.htm">COCOR</a> compiler
construction toolset by Frankie Arzu<br>
- comes with easy to use examples<a
 href="http://cs.ru.ac.za/homes/cspt/cocor.htm"></a><br>
</div>
<span style="font-weight: bold;"><br>
</span>
<div style="margin-left: 40px;">
<div style="margin-left: 40px;"><span style="font-weight: bold;"></span></div>
<div style="margin-left: 40px; font-weight: bold;"><br>
</div>
</div>
<big><span style="font-weight: bold;">Please feel free to contribute
code ideas and suggestions to this project!</span></big><br>
<div style="margin-left: 40px;">
<div style="margin-left: 40px;"><br>
<br>
</div>
</div>
&nbsp;<br>
<table style="background-color: rgb(255, 255, 255); width: 100%;"
 border="0" cellpadding="2" cellspacing="0">
  <tbody>
    <tr>
      <td style="vertical-align: top;">Developers<br>
      </td>
      <td style="vertical-align: top;">Mike Gore <br>
      </td>
      <td style="vertical-align: top;"><a
 href="http://www3.sympatico.ca/magore">http://www3.sympatico.ca/magore</a></td>
    </tr>
    <tr>
      <td style="vertical-align: top;">Links<br>
      </td>
      <td style="vertical-align: top;"><a
 href="http://sourceforge.net/projects/picfloat">Source Forge Project
Page and Downloads</a> <br>
      <a href="http://cvs.sourceforge.net/viewcvs.py/picfloat/">Source
Forge
Project CVS Page</a> <br>
      <a href="mailto:picfloat-general@lists.sourceforge.net">Mailing
List</a><br>
      <a href="http://sourceforge.net/news/?group_id=96893">News</a><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="width: 10%; vertical-align: top;">Support Links:</td>
      <td width="45%"> PARANOIA - Steve Moshiers home page<br>
PSIM&nbsp; Source
Forge<br>
GPUTILS - Source
Forge <br>
      </td>
      <td width="45%"> <a href="http://www.moshier.net">http://www.moshier.net</a><br>
      <a href="http://sourceforge.net/projects/psim">http://sourceforge.net/projects/psim
      </a><br>
      <a href="http://gputils.sourceforge.net/">http://gputils.sourceforge.net/</a></td>
    </tr>
  </tbody>
</table>
<br>
<br>
<table width="100%" border="0" cellpadding="2" cellspacing="0"
 bgcolor="#ffffff">
  <tbody>
    <tr>
      <td width="10%" valign="top"><br>
      </td>
      <td width="45%">
      <p style="margin-bottom: 0cm;"><i>This Site Hosted by</i></p>
      <p><a href="http://sourceforge.net/"><img
 src="http://sourceforge.net/sflogo.php?group_id=96893&amp;type=1"
 name="Graphic1" alt="SourceForge"
 style="border: 0px solid ; width: 88px; height: 31px;"></a></p>
      </td>
      <td width="45%">
      <p style="margin-bottom: 0cm;"><a
 href="mailto:magore@sympatico.ca">Webmaster</a> </p>
      <p>Last updated: 4 Jan 2004<br>
      </p>
      </td>
    </tr>
  </tbody>
</table>
<br>
<br>
</body>
</html>
